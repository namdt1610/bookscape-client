import{j as e,bi as s,bk as P,bl as $,bm as k,bn as g,bA as B,bB as O,bC as V,bD as F,bE as U,bq as q,r as m}from"./index-Bj05vSZy.js";import{u as L}from"./useUserActions-HAFeYzaT.js";import{u as M,a as b,b as y}from"./format.utils-CkYIDAeJ.js";import"./tslib.es6-DtHowTyL.js";const T=({avatar:a,onDrop:c,isEditing:r})=>{const{getRootProps:i,getInputProps:u}=M({onDrop:c,accept:{"image/*":[".jpeg",".jpg",".png"]}});return e.jsx(s.Card,{className:"card-border rounded-full",children:r?e.jsxs("div",{...i(),style:{border:"2px dashed #ccc",padding:"20px",textAlign:"center",cursor:"pointer"},children:[e.jsx("input",{...u()}),e.jsx("img",{src:a,alt:"Avatar Preview",style:{width:300,height:300},className:"rounded-full object-cover"}),e.jsx("p",{children:"Drag or click to change the avatar"})]}):e.jsx("img",{src:a,alt:"avatar",style:{minWidth:300,minHeight:300,borderRadius:"100%",objectFit:"cover"}})})},H=({isEditing:a,onSave:c,onEditToggle:r,onDelete:i})=>e.jsx(s.Card,{className:"items-center justify-center flex card-border",children:e.jsxs(s.Space,{children:[e.jsx(s.Button,{color:"primary",variant:"outlined",size:"large",icon:e.jsx(P,{}),onClick:a?c:r,children:a?"Save":"Edit"}),a&&e.jsx(s.Button,{color:"default",size:"large",variant:"outlined",icon:e.jsx($,{}),onClick:r,children:"Cancel"}),e.jsx(s.Button,{color:"danger",variant:"outlined",size:"large",icon:e.jsx(k,{}),onClick:i,children:"Delete"})]})}),W=({user:a,isEditing:c,editedUser:r,onInputChange:i,errors:u,validations:h})=>e.jsx(e.Fragment,{children:e.jsxs(s.Space,{direction:"vertical",size:"large",children:[e.jsx(s.Card,{title:"Main informations",className:"card-border",children:e.jsxs(s.Descriptions,{layout:"vertical",children:[e.jsx(s.Descriptions.Item,{label:"Name",children:c?e.jsx(s.Input,{prefix:e.jsx(g,{}),size:"large",value:r.name||"",onChange:t=>i("name",t.target.value)}):a.name}),e.jsx(s.Descriptions.Item,{label:"Role",children:c?e.jsxs(s.Select,{size:"large",defaultValue:(r==null?void 0:r.role)||a.role,onChange:t=>i("role",t),children:[e.jsx(s.Select.Option,{value:"admin",children:"Admin"}),e.jsx(s.Select.Option,{value:"user",children:"User"})]}):e.jsx(s.Button,{color:a.role==="admin"?"primary":"default",variant:"filled",className:"uppercase",icon:a.role==="admin"?e.jsx(B,{}):e.jsx(g,{}),children:a.role})}),e.jsxs(s.Descriptions.Item,{label:"Status",children:[e.jsx(s.Badge,{style:{marginRight:10},color:a.status==="active"?"green":"red",status:"processing"}),c?e.jsxs(s.Select,{size:"large",defaultValue:(r==null?void 0:r.status)||"",onChange:t=>i("status",t),children:[e.jsx(s.Select.Option,{value:"active",children:"Active"}),e.jsx(s.Select.Option,{value:"inactive",children:"Inactive"})]}):a.status.charAt(0).toUpperCase()+a.status.slice(1)]})]})}),e.jsx(s.Card,{title:"Contact informations",className:"card-border",children:e.jsxs(s.Descriptions,{layout:"vertical",children:[e.jsx(s.Descriptions.Item,{label:"Email",children:c?e.jsxs("div",{className:"w-full",children:[e.jsx(s.Input,{prefix:e.jsx(O,{}),size:"large",type:"email",value:r.email||"",onChange:t=>i("email",t.target.value),status:h.email?"":"error"}),u.email&&e.jsx(s.Alert,{message:u.email,type:"error",showIcon:!0})]}):a.email}),e.jsx(s.Descriptions.Item,{label:"Password",children:c?e.jsx(s.Input,{prefix:e.jsx(V,{}),size:"large",type:"password",value:r.password||"",onChange:t=>i("password",t.target.value)}):a.role==="admin"?a.password:"You do not have permission to view this field"}),e.jsx(s.Descriptions.Item,{label:"Phone",children:c?e.jsxs("div",{className:"w-full",children:[e.jsx(s.Input,{prefix:e.jsx(F,{}),size:"large",value:r.phone||"",onChange:t=>i("phone",t.target.value),status:h.phone?"":"error"}),u.phone&&e.jsx(s.Alert,{message:u.phone,type:"error",showIcon:!0})]}):a.phone}),e.jsx(s.Descriptions.Item,{label:"Address",children:c?e.jsx(s.Input,{prefix:e.jsx(U,{}),size:"large",value:r.address||"",onChange:t=>i("address",t.target.value)}):a.address})]})}),e.jsx(s.Card,{title:"Recent activities",className:"card-border",children:e.jsxs(s.Descriptions,{layout:"vertical",children:[e.jsx(s.Descriptions.Item,{label:"Created at",children:a.createdAt}),e.jsx(s.Descriptions.Item,{label:"Updated at",children:a.updatedAt})]})})]})}),Q=()=>{const{id:a}=q(),{fetchUserById:c,updateUser:r,deleteUser:i}=L(),[u,h]=m.useState(null),[t,x]=m.useState(!1),[n,j]=m.useState(null),[f,v]=m.useState(null),[w,I]=m.useState({email:"",phone:""}),[D,S]=m.useState({email:!0,phone:!0});m.useEffect(()=>{(async()=>{const l=await c(a);h(l),j(l),v(`http://localhost:8888/${l.avatar}`)})()},[a]);const C=o=>{const l=o[0],p=URL.createObjectURL(l);v(p)},R=()=>{const o={email:b((n==null?void 0:n.email)||""),phone:y((n==null?void 0:n.phone)||"")};return S(o),Object.values(o).every(l=>l===!0)},N=async()=>{const o={email:"",phone:""};if(b((n==null?void 0:n.email)||"")||(s.message.warning("Check your email format"),o.email="Invalid email format (example: yourname@email.com)"),y((n==null?void 0:n.phone)||"")||(s.message.warning("Check your phone number format"),o.phone="Invalid phone number format"),o.email||o.phone){I(o);return}try{if(!R()){s.message.warning("Please check your input fields");return}const l=new FormData;for(const d in n)l.append(d,n[d]);if(f){const d=document.querySelector('input[type="file"]');d!=null&&d.files[0]&&l.append("avatar",d.files[0])}l.forEach((d,E)=>{console.log(E+": "+d)});const p=s.message.loading("Saving...",0);setTimeout(async()=>{try{const d=await r(a,l);h(d),x(!1),p(),s.message.success("User updated successfully")}catch(d){console.error("Error during save:",d),p(),s.message.error("Error occurred while saving")}},1e3)}catch(l){console.error("Error during save:",l)}},A=()=>{x(!t)},z=async()=>{try{await i(a),s.message.success("User deleted successfully"),console.log("User deleted successfully"),window.location.href="/admin/users"}catch(o){console.error("Error during delete:",o)}};return u?e.jsx("div",{className:"py-4",children:e.jsx(s.Space,{className:"flex items-center justify-center",direction:"vertical",size:"large",children:e.jsxs("div",{className:"flex gap-4 items-center ",children:[e.jsx("div",{className:" h-full items-center flex flex-col justify-center",children:e.jsxs(s.Card,{className:"card-border",children:[e.jsx(H,{isEditing:t,onSave:N,onEditToggle:A,onDelete:z}),e.jsx(T,{avatar:f||`http://localhost:8888/${u.avatar}`,onDrop:C,isEditing:t})]})}),e.jsx("div",{children:e.jsx(W,{user:u,isEditing:t,editedUser:n||{},onInputChange:(o,l)=>j(p=>({...p,[o]:l})),errors:w,validations:D})})]})})}):e.jsx(s.Spin,{size:"large",fullscreen:!0})};export{Q as default};
//# sourceMappingURL=UserDetails-Be4-cw4U.js.map
