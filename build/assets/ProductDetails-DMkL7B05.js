import{j as e,bi as s,bk as R,bl as C,bm as E,bn as $,bo as A,bp as F,bq as N,r as g}from"./index-Bj05vSZy.js";import{u as q}from"./useProductActions-L2gtlfnW.js";import{u as B,i as v}from"./format.utils-CkYIDAeJ.js";import"./tslib.es6-DtHowTyL.js";const U=({image:r,onDrop:i,isEditing:c})=>{const{getRootProps:l,getInputProps:p}=B({onDrop:i,accept:{"image/*":[".jpeg",".jpg",".png"]}});return e.jsx(e.Fragment,{children:c?e.jsxs("div",{...l(),style:{border:"2px dashed #ccc",padding:"20px",textAlign:"center",cursor:"pointer"},children:[e.jsx("input",{...p()}),e.jsx("img",{src:r,alt:"Image Preview",style:{width:300,height:300},className:"rounded object-cover"}),e.jsx("p",{children:"Drag or click to change the image"})]}):e.jsx("img",{src:r,alt:"image",style:{width:300,height:300,borderRadius:"10%",objectFit:"cover"}})})},V=({isEditing:r,onSave:i,onEditToggle:c,onDelete:l})=>e.jsxs(s.Space,{children:[e.jsx(s.Button,{color:"primary",variant:"outlined",size:"large",icon:e.jsx(R,{}),onClick:r?i:c,children:r?"Save":"Edit"}),r&&e.jsx(s.Button,{color:"default",size:"large",variant:"outlined",icon:e.jsx(C,{}),onClick:c,children:"Cancel"}),e.jsx(s.Button,{color:"danger",variant:"outlined",size:"large",icon:e.jsx(E,{}),onClick:l,children:"Delete"})]}),L=({product:r,isEditing:i,editedProduct:c,onInputChange:l,errors:p,validations:d})=>e.jsxs(s.Space,{direction:"vertical",size:"large",children:[e.jsx(s.Card,{title:"Product Information",children:e.jsxs(s.Descriptions,{layout:"vertical",children:[e.jsx(s.Descriptions.Item,{label:"Name",children:i?e.jsx(s.Input,{prefix:e.jsx($,{}),size:"large",value:c.name||"",onChange:o=>l("name",o.target.value)}):r.name}),e.jsx(s.Descriptions.Item,{label:"Price",children:i?e.jsx(s.Input,{prefix:e.jsx(A,{}),size:"large",value:c.price||"",onChange:o=>l("price",o.target.value)}):r.price}),e.jsx(s.Descriptions.Item,{label:"SKU",children:i?e.jsx(s.Input,{prefix:e.jsx(F,{}),size:"large",value:c.sku||"",onChange:o=>l("sku",o.target.value)}):r.sku})]})}),e.jsx(s.Card,{title:"Additional Information",children:e.jsxs(s.Descriptions,{layout:"vertical",children:[e.jsx(s.Descriptions.Item,{label:"Category",children:i?e.jsx(s.Select,{size:"large",defaultValue:(c==null?void 0:c.category)||r.category,onChange:o=>l("category",o)}):r.category}),e.jsx(s.Descriptions.Item,{label:"Stock",children:i?e.jsx(s.Input,{size:"large",value:c.stock||"",onChange:o=>l("stock",o.target.value)}):r.stock})]})})]}),G=()=>{const{id:r}=N(),{fetchProductById:i,updateProduct:c,deleteProduct:l}=q(),[p,d]=g.useState(null),[o,x]=g.useState(!1),[t,f]=g.useState(null),[h,j]=g.useState(null),[y,k]=g.useState({name:"",price:"",sku:""}),[b,S]=g.useState({name:!0,price:!0,sku:!0});g.useEffect(()=>{(async()=>{const n=await i(r);d(n),f(n),j(`http://localhost:8888/${n.avatar}`)})()},[r]);const I=a=>{const n=a[0],m=URL.createObjectURL(n);j(m)},w=()=>{const a={name:!!(t!=null&&t.name),price:v(String((t==null?void 0:t.price)||"")),sku:!!(t!=null&&t.sku)};return S(a),Object.values(a).every(n=>n===!0)},D=async()=>{const a={name:"",price:"",sku:""};if(t!=null&&t.name||(s.message.warning("Name is required"),a.name="Name is required"),v(String((t==null?void 0:t.price)||""))||(s.message.warning("Check your price format"),a.price="Invalid price format"),a.name||a.price||a.sku){k(a);return}try{if(!w()){s.message.warning("Please check your input fields");return}const n=new FormData;for(const u in t)n.append(u,t[u]);if(h){const u=document.querySelector('input[type="file"]');u!=null&&u.files[0]&&n.append("avatar",u.files[0])}const m=s.message.loading("Saving...",0);setTimeout(async()=>{try{const u=await c(r,n);d(u),x(!1),m(),s.message.success("Product updated successfully")}catch(u){console.error("Error during save:",u),m(),s.message.error("Error occurred while saving")}},1e3)}catch(n){console.error("Error during save:",n)}},z=()=>{x(!o)},P=async()=>{try{await l(r),s.message.success("Product deleted successfully"),console.log("Product deleted successfully"),window.location.href="/admin/products"}catch(a){console.error("Error during delete:",a)}};return p?e.jsx("div",{children:e.jsxs(s.Space,{className:"flex items-center justify-center",direction:"vertical",size:"large",children:[e.jsx(V,{isEditing:o,onSave:D,onEditToggle:z,onDelete:P}),e.jsx(U,{image:h||`http://localhost:8888/${p.image}`,onDrop:I,isEditing:o}),e.jsx(L,{product:p,isEditing:o,editedProduct:t||{},onInputChange:(a,n)=>f(m=>({...m,[a]:n})),errors:y,validations:b})]})}):e.jsx(s.Spin,{size:"large",fullscreen:!0})};export{G as default};
//# sourceMappingURL=ProductDetails-DMkL7B05.js.map
